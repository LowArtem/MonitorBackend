using Microsoft.AspNetCore.Mvc;
using MonitorBackend.Controllers.Abstract;
using MonitorBackend.Data.Dto;
using MonitorBackend.Data.Dto.Mapper;
using MonitorBackend.Services;

namespace MonitorBackend.Controllers;

public class MalwareController : BaseApiController
{
    private readonly MalwareService _malwareService;

    public MalwareController(MalwareService malwareService)
    {
        _malwareService = malwareService;
    }

    [HttpGet]
    [Route("")]
    public async Task<ActionResult<List<MalwareDto>>> GetMalwares()
    {
        var malwares = await _malwareService.GetAllMalwares();
        return malwares == null ? BadRequest("Error") : Ok(malwares.Select(m => m.MapToDto()));
    }
    
    [HttpGet]
    [Route("computer/{computerId:int}")]
    public async Task<ActionResult<List<MalwareDto>>> GetMalwares(int computerId)
    {
        var malwares = await _malwareService.GetMalwaresByComputerId(computerId);
        return malwares == null ? BadRequest("Error") : Ok(malwares.Select(m => m.MapToDto()));
    }
}